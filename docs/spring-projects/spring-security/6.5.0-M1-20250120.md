# 6.5.0-M1

## release on 20250120

## description

## changes

‚≠ê New Features

* Add <code>@AuthenticationPrincipal</code>/<code>@CurrentSecurityContext</code> Interface Support for Expression Templates <a href="https://github.com/spring-projects/spring-security/pull/16201" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16201/hovercard">#16201</a>
* Add ClientRegistration.clientSettings.requireProofKey to Enable PKCE <a href="https://github.com/spring-projects/spring-security/pull/16386" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16386/hovercard">#16386</a>
* Add support checking same security matchers <a href="https://github.com/spring-projects/spring-security/pull/16186" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16186/hovercard">#16186</a>
* Add Support disableDefaultRegistrationPage to WebAuthnDsl <a href="https://github.com/spring-projects/spring-security/issues/16404" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16404/hovercard">#16404</a>
* Add support fullyAuthenticated to Kotlin DSL <a href="https://github.com/spring-projects/spring-security/pull/16190" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16190/hovercard">#16190</a>
* Add Support JDBC Repositories For WebAuthn <a href="https://github.com/spring-projects/spring-security/pull/16282" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16282/hovercard">#16282</a>
* Add Support OAuth2AuthorizationRequestResolver As Bean <a href="https://github.com/spring-projects/spring-security/pull/16381" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16381/hovercard">#16381</a>
* Add UserDetailsService Constructor <a href="https://github.com/spring-projects/spring-security/pull/15984" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/15984/hovercard">#15984</a>
* Add WebAuthnConfigurer HttpMessageConverter Support <a href="https://github.com/spring-projects/spring-security/pull/16397" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16397/hovercard">#16397</a>
* Added a constant for DPOP in OAuth2AccessToken.TokenType <a href="https://github.com/spring-projects/spring-security/pull/16087" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16087/hovercard">#16087</a>
* Allow configuring custom ServerHttpHeadersWriter for Kotlin DSL <a href="https://github.com/spring-projects/spring-security/pull/16136" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16136/hovercard">#16136</a>
* Avoid unnecessary instantiation of HttpSecurity <a href="https://github.com/spring-projects/spring-security/pull/16370" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16370/hovercard">#16370</a>
* Consider making the constructor of <code>OAuth2AccessToken.TokenType</code> <code>public</code> <a href="https://github.com/spring-projects/spring-security/issues/16086" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16086/hovercard">#16086</a>
* Customize Redirect URI in OidcClientInitiatedServerLogoutSuccessHandler <a href="https://github.com/spring-projects/spring-security/pull/14808" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/14808/hovercard">#14808</a>
* Documentation code snippets should consistently use joint tabs for java, kotlin, & XML <a href="https://github.com/spring-projects/spring-security/issues/16228" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16228/hovercard">#16228</a>
* Fix OAuth reference documentation typo <a href="https://github.com/spring-projects/spring-security/pull/16350" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16350/hovercard">#16350</a>
* Redirect using a relative URL <a href="https://github.com/spring-projects/spring-security/issues/7273" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/7273/hovercard">#7273</a>
* Set PublicKeyCredentialCreationOptionsRepository by DSL or Bean <a href="https://github.com/spring-projects/spring-security/pull/16396" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16396/hovercard">#16396</a>
* Suggest replacing size() == 0 with isEmpty() for collection check <a href="https://github.com/spring-projects/spring-security/pull/16428" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16428/hovercard">#16428</a>
* Support Determining Max Sessions by Authentication <a href="https://github.com/spring-projects/spring-security/pull/16218" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16218/hovercard">#16218</a>
* Use relative URLs in /login redirects <a href="https://github.com/spring-projects/spring-security/pull/14714" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/14714/hovercard">#14714</a>

ü™≤ Bug Fixes

* Encode clientId and clientSecret for <code>OpaqueTokenIntrospector</code> and <code>ReactiveOpaqueTokenIntrospector</code> <a href="https://github.com/spring-projects/spring-security/pull/16008" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16008/hovercard">#16008</a>
* Fix broken link <a href="https://github.com/spring-projects/spring-security/pull/16416" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16416/hovercard">#16416</a>
* Fix broken link to MockMvc documentation <a href="https://github.com/spring-projects/spring-security/pull/16415" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16415/hovercard">#16415</a>
* Fix for JdbcOneTimeTokenService cleanupExpiredTokens failing with PostgreSQL <a href="https://github.com/spring-projects/spring-security/issues/16409" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16409/hovercard">#16409</a>
* Fix incorrect rendering of SpEL expression example tabs <a href="https://github.com/spring-projects/spring-security/pull/16343" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16343/hovercard">#16343</a>
* Fix Kotlin DSL webAuthn { } <a href="https://github.com/spring-projects/spring-security/issues/16403" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16403/hovercard">#16403</a>
* Fix logout code snippet for Kotlin <a href="https://github.com/spring-projects/spring-security/pull/16341" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16341/hovercard">#16341</a>
* Fix missing space in documentation <a href="https://github.com/spring-projects/spring-security/pull/16353" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16353/hovercard">#16353</a>
* Fix WebAuthnWebdriverTests <a href="https://github.com/spring-projects/spring-security/issues/16283" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16283/hovercard">#16283</a>
* Fixed grammatical mistakes/errors in the docs. <a href="https://github.com/spring-projects/spring-security/pull/16232" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16232/hovercard">#16232</a>
* Fixed typo in WebAuthnDsl <a href="https://github.com/spring-projects/spring-security/pull/16413" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16413/hovercard">#16413</a>
* Kotlin MVC Integration Docs should use servlet path parameter <a href="https://github.com/spring-projects/spring-security/issues/16426" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16426/hovercard">#16426</a>
* method-security: fix invalid Kotlin syntax <a href="https://github.com/spring-projects/spring-security/pull/16375" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16375/hovercard">#16375</a>
* Update docs to link to AuthorizationFilter instead of deprecated FilterSecurityInterceptor <a href="https://github.com/spring-projects/spring-security/pull/16352" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16352/hovercard">#16352</a>
* Use spring.security prefix instead of security.security <a href="https://github.com/spring-projects/spring-security/pull/16427" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16427/hovercard">#16427</a>
* WebAuthn login fails when CredentialsRequestOptions.publicKey.allowCredentials is not empty <a href="https://github.com/spring-projects/spring-security/issues/16441" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16441/hovercard">#16441</a>

üî® Dependency Upgrades

* Bump ch.qos.logback:logback-classic from 1.5.15 to 1.5.16 <a href="https://github.com/spring-projects/spring-security/pull/16366" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16366/hovercard">#16366</a>
* Bump com.webauthn4j:webauthn4j-core from 0.28.3.RELEASE to 0.28.4.RELEASE <a href="https://github.com/spring-projects/spring-security/pull/16356" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16356/hovercard">#16356</a>
* Bump io.micrometer:micrometer-observation from 1.14.2 to 1.14.3 <a href="https://github.com/spring-projects/spring-security/pull/16411" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16411/hovercard">#16411</a>
* Bump io.mockk:mockk from 1.13.14 to 1.13.16 <a href="https://github.com/spring-projects/spring-security/pull/16402" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16402/hovercard">#16402</a>
* Bump io.projectreactor:reactor-bom from 2023.0.13 to 2023.0.14 <a href="https://github.com/spring-projects/spring-security/pull/16419" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16419/hovercard">#16419</a>
* Bump org-bouncycastle from 1.79 to 1.80 <a href="https://github.com/spring-projects/spring-security/pull/16418" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16418/hovercard">#16418</a>
* Bump org.assertj:assertj-core from 3.27.2 to 3.27.3 <a href="https://github.com/spring-projects/spring-security/pull/16447" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16447/hovercard">#16447</a>
* Bump org.hibernate.orm:hibernate-core from 6.6.4.Final to 6.6.5.Final <a href="https://github.com/spring-projects/spring-security/pull/16448" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16448/hovercard">#16448</a>
* Bump org.htmlunit:htmlunit from 4.7.0 to 4.8.0 <a href="https://github.com/spring-projects/spring-security/pull/16401" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16401/hovercard">#16401</a>
* Bump org.jetbrains.kotlinx:kotlinx-coroutines-bom from 1.10.0 to 1.10.1 <a href="https://github.com/spring-projects/spring-security/pull/16333" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16333/hovercard">#16333</a>
* Bump org.junit:junit-bom from 5.11.3 to 5.11.4 <a href="https://github.com/spring-projects/spring-security/pull/16293" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16293/hovercard">#16293</a>
* Bump org.mockito:mockito-bom from 5.14.2 to 5.15.2 <a href="https://github.com/spring-projects/spring-security/pull/16360" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16360/hovercard">#16360</a>
* Bump org.springframework.data:spring-data-bom from 2024.1.1 to 2024.1.2 <a href="https://github.com/spring-projects/spring-security/pull/16449" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16449/hovercard">#16449</a>
* Bump org.springframework:spring-framework-bom from 6.2.1 to 6.2.2 <a href="https://github.com/spring-projects/spring-security/pull/16435" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16435/hovercard">#16435</a>

üî© Build Updates

* Polish AbstractHttpConfigurer <a href="https://github.com/spring-projects/spring-security/pull/16362" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16362/hovercard">#16362</a>
* Remove unused code from WebSecurityConfiguration <a href="https://github.com/spring-projects/spring-security/pull/16348" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16348/hovercard">#16348</a>
* Remove Unused Loggers from Request Matchers <a href="https://github.com/spring-projects/spring-security/pull/16319" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-security/pull/16319/hovercard">#16319</a>
* Troubleshoot missing GChat notifications <a href="https://github.com/spring-projects/spring-security/issues/16425" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-security/issues/16425/hovercard">#16425</a>

‚ù§Ô∏è Contributors

Thank you to all the contributors who worked on this release:

<a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/2-say/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/2-say">@2-say</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ClaudenirFreitas/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ClaudenirFreitas">@ClaudenirFreitas</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Meehdi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Meehdi">@Meehdi</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/MuhammadNFadhil/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/MuhammadNFadhil">@MuhammadNFadhil</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Pistolnik/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Pistolnik">@Pistolnik</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ThomasKasene/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ThomasKasene">@ThomasKasene</a>, <a class="user-mention notranslate" data-hovercard-type="organization" data-hovercard-url="/orgs/dependabot/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/dependabot">@dependabot</a>[bot], <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/evgeniycheban/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/evgeniycheban">@evgeniycheban</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/franticticktick/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/franticticktick">@franticticktick</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/harcomaase/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/harcomaase">@harcomaase</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/intotherealworld/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/intotherealworld">@intotherealworld</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/jzheaux/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/jzheaux">@jzheaux</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/kse-music/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/kse-music">@kse-music</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/mehdirahimi/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/mehdirahimi">@mehdirahimi</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/ngocnhan-tran1996/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/ngocnhan-tran1996">@ngocnhan-tran1996</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/simaotwx/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/simaotwx">@simaotwx</a>, and <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/wndyd0131/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/wndyd0131">@wndyd0131</a>

