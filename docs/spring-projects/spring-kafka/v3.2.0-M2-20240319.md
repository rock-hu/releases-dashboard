# v3.2.0-M2

## release on 20240319

## description

## changes

‚≠ê New Features

* Upgrade Apache Kafka client version to 3.7.0 <a href="https://github.com/spring-projects/spring-kafka/issues/3116" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3116/hovercard">#3116</a>
* <code>@RetryableTopic</code> support KL annotated on class part 2 <a href="https://github.com/spring-projects/spring-kafka/pull/3112" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3112/hovercard">#3112</a>
* <code>@RetryableTopic</code> support <code>@KafkaListener</code> annotated on class part 1 <a href="https://github.com/spring-projects/spring-kafka/pull/3107" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3107/hovercard">#3107</a>
* Correct class naming convention for 'hat' in serializer/deserializer Doc <a href="https://github.com/spring-projects/spring-kafka/pull/3106" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3106/hovercard">#3106</a>
* polish retryable topic. <a href="https://github.com/spring-projects/spring-kafka/pull/3104" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3104/hovercard">#3104</a>
* fix bug at KafkaMessageListenerContainerTests.testInvokeRecordInterceptorAllSkipped() <a href="https://github.com/spring-projects/spring-kafka/pull/3091" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3091/hovercard">#3091</a>
* Polish KafkaMessageListenerContainer <a href="https://github.com/spring-projects/spring-kafka/pull/3090" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3090/hovercard">#3090</a>
* Fix race condition at TransactionalContainerTests.testBatchListenerRecoverAfterRollbackProcessorCrash <a href="https://github.com/spring-projects/spring-kafka/pull/3081" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3081/hovercard">#3081</a>
* Polish KafkaMessageListenerContainer <a href="https://github.com/spring-projects/spring-kafka/pull/3079" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3079/hovercard">#3079</a>
* Compute New Seek Position From Current Offset <a href="https://github.com/spring-projects/spring-kafka/issues/3078" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3078/hovercard">#3078</a>
* <a class="issue-link js-issue-link" data-error-text="Failed to load title" data-id="1850316093" data-permission-text="Title is private" data-url="https://github.com/spring-projects/spring-kafka/issues/2775" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/2775/hovercard" href="https://github.com/spring-projects/spring-kafka/issues/2775">GH-2775</a>: Deprecate ContainerProperties properties transactionManager <a href="https://github.com/spring-projects/spring-kafka/pull/3066" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3066/hovercard">#3066</a>
* Polish KafkaTemplate <a href="https://github.com/spring-projects/spring-kafka/pull/3065" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3065/hovercard">#3065</a>
* ConcurrentMessageListenerContainer#isInExpectedState consistency problem <a href="https://github.com/spring-projects/spring-kafka/pull/3063" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3063/hovercard">#3063</a>
* Fix TestOOMError#testOOMCMLC throw ConcurrentModificationException <a href="https://github.com/spring-projects/spring-kafka/pull/3059" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3059/hovercard">#3059</a>
* ReactiveKafkaConsumerTemplate missing receiveBatch method <a href="https://github.com/spring-projects/spring-kafka/issues/3057" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3057/hovercard">#3057</a>
* Change <code>@RetryableTopic</code> properties SameIntervalTopicReuseStrategy behavior to SINGLE_TOPIC <a href="https://github.com/spring-projects/spring-kafka/issues/3052" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3052/hovercard">#3052</a>
* Add properties to ContainerProperties.toString <a href="https://github.com/spring-projects/spring-kafka/pull/3046" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3046/hovercard">#3046</a>
* polish adoc for kafka chapter <a href="https://github.com/spring-projects/spring-kafka/pull/3045" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3045/hovercard">#3045</a>
* Cleanup ConcurrentMessageListenerContainerMockTests <a href="https://github.com/spring-projects/spring-kafka/pull/3044" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3044/hovercard">#3044</a>
* Provide API methods of accessing <code>HostInfo</code> in <code>KafkaStreamsInteractiveQueryService</code> <a href="https://github.com/spring-projects/spring-kafka/issues/3034" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3034/hovercard">#3034</a>
* Non-blocking retry using KafkaListener on class level <a href="https://github.com/spring-projects/spring-kafka/issues/3012" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3012/hovercard">#3012</a>
* Use application name as default clientId <a href="https://github.com/spring-projects/spring-kafka/issues/3001" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3001/hovercard">#3001</a>

üêû Bug Fixes

* Failing to handle deserialization exceptions in batch listener <a href="https://github.com/spring-projects/spring-kafka/issues/3114" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3114/hovercard">#3114</a>
* Unsafe access to Kafka consumer in seek operation <a href="https://github.com/spring-projects/spring-kafka/issues/3108" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3108/hovercard">#3108</a>
* <code>KafkaMessageListenerContainer</code> doesn't properly clear threadState of <code>AfterRollbackProcessor</code> <a href="https://github.com/spring-projects/spring-kafka/issues/3076" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3076/hovercard">#3076</a>
* CommonDelegatingErrorHandler does not check delegates compatibility correctly <a href="https://github.com/spring-projects/spring-kafka/issues/3050" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3050/hovercard">#3050</a>
* Listener exceptions not saved to the observation <a href="https://github.com/spring-projects/spring-kafka/issues/3049" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3049/hovercard">#3049</a>
* Enhanced monitoring when KMLC is batch listener <a href="https://github.com/spring-projects/spring-kafka/pull/3047" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3047/hovercard">#3047</a>
* fix bug about method ConsumerSeekAware.seekRelative <a href="https://github.com/spring-projects/spring-kafka/pull/3043" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3043/hovercard">#3043</a>
* DefaultErrorHandler is not able to seek in case of an exception during the commit <a href="https://github.com/spring-projects/spring-kafka/issues/3019" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/3019/hovercard">#3019</a>
* Calling DefaultKafkaHeaderMapper constructor with the same ObjectMapper instance may result memory leak <a href="https://github.com/spring-projects/spring-kafka/issues/2611" data-hovercard-type="issue" data-hovercard-url="/spring-projects/spring-kafka/issues/2611/hovercard">#2611</a>

üìî Documentation

* Remove retry-topic-lcf.adoc introduce useLegacyFactoryConfigurer <a href="https://github.com/spring-projects/spring-kafka/pull/3084" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3084/hovercard">#3084</a>
* Non-Blocking Retries cannot combine with container transactions. <a href="https://github.com/spring-projects/spring-kafka/pull/3072" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3072/hovercard">#3072</a>

üî® Dependency Upgrades

* Bump org.springframework:spring-framework-bom from 6.1.4 to 6.1.5 <a href="https://github.com/spring-projects/spring-kafka/pull/3130" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3130/hovercard">#3130</a>
* Bump io.projectreactor:reactor-bom from 2023.0.3 to 2023.0.4 <a href="https://github.com/spring-projects/spring-kafka/pull/3129" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3129/hovercard">#3129</a>
* Bump org.apache.zookeeper:zookeeper from 3.8.3 to 3.8.4 <a href="https://github.com/spring-projects/spring-kafka/pull/3111" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3111/hovercard">#3111</a>
* Bump kotlinVersion from 1.9.22 to 1.9.23 <a href="https://github.com/spring-projects/spring-kafka/pull/3110" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3110/hovercard">#3110</a>
* Bump com.github.spotbugs from 6.0.7 to 6.0.8 <a href="https://github.com/spring-projects/spring-kafka/pull/3096" data-hovercard-type="pull_request" data-hovercard-url="/spring-projects/spring-kafka/pull/3096/hovercard">#3096</a>

‚ù§Ô∏è Contributors

Thank you to all the contributors who worked on this release:

<a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/Wzy19930507/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/Wzy19930507">@Wzy19930507</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/qeeqez/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/qeeqez">@qeeqez</a>, <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/selllami/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/selllami">@selllami</a>, and <a class="user-mention notranslate" data-hovercard-type="user" data-hovercard-url="/users/sobychacko/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/sobychacko">@sobychacko</a>

